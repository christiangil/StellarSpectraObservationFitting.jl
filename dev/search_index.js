var documenterSearchIndex = {"docs":
[{"location":"gettingstarted/#Getting-Started","page":"Getting Started","title":"Getting Started","text":"","category":"section"},{"location":"gettingstarted/#Installation","page":"Getting Started","title":"Installation","text":"","category":"section"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"The most current, tagged version of StellarSpectraObservationFitting.jl can be easily installed using Julia's Pkg","category":"page"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"Pkg.add(\"StellarSpectraObservationFitting\")","category":"page"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"If you would like to contribute to the package, or just want to run the latest (untagged) version, you can use the following","category":"page"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"Pkg.develop(\"StellarSpectraObservationFitting\")","category":"page"},{"location":"gettingstarted/#Example","page":"Getting Started","title":"Example","text":"","category":"section"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"An example notebook can be found here","category":"page"},{"location":"gettingstarted/#Getting-Help","page":"Getting Started","title":"Getting Help","text":"","category":"section"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"To get help on specific functionality you can either look up the information here, or if you prefer you can make use of Julia's native doc-system. For example here's how to get additional information on StellarSpectraObservationFitting.calculate_initial_model within Julia's REPL:","category":"page"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"?StellarSpectraObservationFitting.calculate_initial_model","category":"page"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"If you encounter a bug or would like to participate in the development of this package come find us on Github.","category":"page"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"christiangil/StellarSpectraObservationFitting.jl","category":"page"},{"location":"continuum/#Continuum-functions","page":"Continuum","title":"Continuum functions","text":"","category":"section"},{"location":"continuum/","page":"Continuum","title":"Continuum","text":"Modules = [StellarSpectraObservationFitting]\nPages   = [\"src/continuum_functions.jl\"]","category":"page"},{"location":"continuum/#StellarSpectraObservationFitting.bad_pixel_flagger-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.bad_pixel_flagger","text":"bad_pixel_flagger(y, σ²; prop=.005, thres=8)\n\nFind anomalous pixels where δ⁴y/δ⁴x is high, passing prop and thres to outlier_mask()\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.continuum_normalize!-Tuple{StellarSpectraObservationFitting.Data}","page":"Continuum","title":"StellarSpectraObservationFitting.continuum_normalize!","text":"continuum_normalize!(d; order=6, kwargs...)\n\nDivide d.flux (and d.var) by its sigma-clipped polynomial continuum (or its square)\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.fit_continuum-Tuple{AbstractVector{T} where T, AbstractVector{T} where T, AbstractVector{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.fit_continuum","text":"fit_continuum(x, y, σ²; ignore_weights=false, order=6, nsigma=[0.5,3.0], maxniter=50, edge_mask::Int=0)\n\nFit the continuum of y with a polynomial of order order using assymetric sigma-clipping, similar to wobble\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.flat_normalize!-Tuple{StellarSpectraObservationFitting.Data}","page":"Continuum","title":"StellarSpectraObservationFitting.flat_normalize!","text":"flat_normalize!(d; kwargs...)\n\nDivide d.flux (and d.var) by its 0.9 quantile value (or its square)\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.mask_bad_edges!-NTuple{4, AbstractMatrix{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.mask_bad_edges!","text":"mask_bad_edges!(y, σ², log_λ_star, log_λ_star_bounds; window_width=128, min_snr=8., verbose=true, always_mask_something=false, edges=nothing, kwargs...)\n\nMask out edges of y (either given by edges or where y/σ is on average below min_snr)\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.mask_bad_pixel!-NTuple{4, AbstractMatrix{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.mask_bad_pixel!","text":"mask_bad_pixel!(y, σ², log_λ_star, log_λ_star_bounds; padding=2, include_bary_shifts=false, verbose=true, bad_pixels=nothing, kwargs...)\n\nMask anomalous pixels where δ⁴y/δ⁴x is high\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.mask_high_pixels!-Tuple{AbstractVector{T} where T, AbstractVector{T} where T, AbstractVector{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.mask_high_pixels!","text":"mask_high_pixels!(bad, y, σ²; padding=0, max_flux=2., padding=2, using_weights=false)\n\nMask out pixels whose y values are above max_flux\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.mask_infinite_pixels!-NTuple{4, AbstractMatrix{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.mask_infinite_pixels!","text":"mask_infinite_pixels!(y, σ², log_λ_star, log_λ_star_bounds; padding=0, include_bary_shifts=false, verbose=true, kwargs...)\n\nMask out pixels whose y or σ² values are infinite\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.mask_isolated_pixels!-Tuple{AbstractMatrix{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.mask_isolated_pixels!","text":"mask_isolated_pixels!(σ²; neighbors_required::Int=29, verbose::Bool=true)\n\nMask between two flagged pixels if there are fewer than neighbors_required pixels between them\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.mask_low_pixels!-Tuple{AbstractVector{T} where T, AbstractVector{T} where T, AbstractVector{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.mask_low_pixels!","text":"mask_low_pixels!(bad, y, σ²; padding=0, min_flux=0., padding=2, using_weights=false)\n\nMask out pixels whose y values are below min_flux\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.outlier_mask-Tuple{AbstractVecOrMat{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.outlier_mask","text":"outlier_mask(v; thres=10, prop=0.2, return_stats=false, only_low::Bool=false)\n\nMask outliers in v that are outside thres-σ after winsorizing out the top and bottom prop quantiles\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.process!-Tuple{Any}","page":"Continuum","title":"StellarSpectraObservationFitting.process!","text":"process!(d; λ_thres=4000., min_snr=8, kwargs...)\n\nDoing all of the data preprocessing, including continuum-fitting and masking\n\n\n\n\n\n","category":"method"},{"location":"continuum/#StellarSpectraObservationFitting.snap-Tuple{AbstractMatrix{T} where T}","page":"Continuum","title":"StellarSpectraObservationFitting.snap","text":"snap(y)\n\nEstimate δ⁴y/δ⁴x (a.k.a. the snap) with finite differences. See https://en.wikipedia.org/wiki/Finitedifference#Higher-orderdifferences\n\n\n\n\n\n","category":"method"},{"location":"indices/#Index","page":"Indices","title":"Index","text":"","category":"section"},{"location":"indices/","page":"Indices","title":"Indices","text":"","category":"page"},{"location":"indices/","page":"Indices","title":"Indices","text":"Modules = [StellarSpectraObservationFitting]","category":"page"},{"location":"indices/#StellarSpectraObservationFitting.Adam","page":"Indices","title":"StellarSpectraObservationFitting.Adam","text":"Adam\n\nHolds information used for Adaptive Moment Estimation optimization\n\n\n\n\n\n","category":"type"},{"location":"indices/#StellarSpectraObservationFitting.AdamState","page":"Indices","title":"StellarSpectraObservationFitting.AdamState","text":"AdamState\n\nHolds diagonstic information on the current state of an ADAM opmitization\n\n\n\n\n\n","category":"type"},{"location":"indices/#StellarSpectraObservationFitting.AdamSubWorkspace","page":"Indices","title":"StellarSpectraObservationFitting.AdamSubWorkspace","text":"AdamSubWorkspace\n\nHolds a set of model parameters and the ADAM optimizer and functions used to optimize them\n\n\n\n\n\n","category":"type"},{"location":"indices/#StellarSpectraObservationFitting.FrozenTelWorkspace","page":"Indices","title":"StellarSpectraObservationFitting.FrozenTelWorkspace","text":"FrozenTelWorkspace\n\nA workspace to optimize all of the parameters in a SSOF model (except for the tellruc template and features) and data it is to be optimized on\n\n\n\n\n\n","category":"type"},{"location":"indices/#StellarSpectraObservationFitting.ModelWorkspace-Tuple{StellarSpectraObservationFitting.OrderModel, StellarSpectraObservationFitting.Data}","page":"Indices","title":"StellarSpectraObservationFitting.ModelWorkspace","text":"ModelWorkspace(model, data)\n\nCreate a workspace for optimizing model with data Creates a FrozenTelWorkspace if the model has no telluric feature vectors and an empty telluric template\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.OptimSubWorkspace","page":"Indices","title":"StellarSpectraObservationFitting.OptimSubWorkspace","text":"OptimSubWorkspace\n\nHolds a set of model parameters and the Optim optimizer and functions used to optimize them\n\n\n\n\n\n","category":"type"},{"location":"indices/#StellarSpectraObservationFitting.OptimTelStarWorkspace","page":"Indices","title":"StellarSpectraObservationFitting.OptimTelStarWorkspace","text":"OptimTelStarWorkspace\n\nA workspace to go back and forth optimizing the telluric and stellar parameters then the RVs in a SSOF model and data it is to be optimized on Uses methods in Optim\n\n\n\n\n\n","category":"type"},{"location":"indices/#StellarSpectraObservationFitting.OptimTotalWorkspace","page":"Indices","title":"StellarSpectraObservationFitting.OptimTotalWorkspace","text":"OptimTotalWorkspace\n\nA workspace to optimize all of the parameters in a SSOF model and data it is to be optimized on Uses methods in Optim\n\n\n\n\n\n","category":"type"},{"location":"indices/#StellarSpectraObservationFitting.TotalWorkspace","page":"Indices","title":"StellarSpectraObservationFitting.TotalWorkspace","text":"TotalWorkspace\n\nA workspace to optimize all of the parameters in a SSOF model and data it is to be optimized on Uses our custom implementation of ADAM\n\n\n\n\n\n","category":"type"},{"location":"indices/#ParameterHandling.flatten-Union{Tuple{T}, Tuple{Type{T}, StellarSpectraObservationFitting.LinearModel}} where T<:Real","page":"Indices","title":"ParameterHandling.flatten","text":"flatten([eltype=Real], x::LinearModel)\n\nReturns a \"flattened\" representation of x::LinearModel as a vector of vectors and a function unflatten that takes a vector of reals of the same length and returns a LinearModel object\n\n\n\n\n\n","category":"method"},{"location":"indices/#ParameterHandling.flatten-Union{Tuple{T}, Tuple{Type{T}, SubArray}} where T<:Real","page":"Indices","title":"ParameterHandling.flatten","text":"flatten([eltype=Real], x::SubArray)\n\nReturns a \"flattened\" representation of x::SubArray as a vector and a function unflatten that takes a vector of reals of the same length and returns an Array object\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.AdamState!-Tuple{StellarSpectraObservationFitting.AdamState, Any, Any}","page":"Indices","title":"StellarSpectraObservationFitting.AdamState!","text":"AdamState!(as, ℓ, Δ)\n\nUpdate as with the next iteration's loss and gradient\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting._OSW_optimize!-Tuple{StellarSpectraObservationFitting.OptimSubWorkspace, Optim.Options}","page":"Indices","title":"StellarSpectraObservationFitting._OSW_optimize!","text":"_OSW_optimize!(osw, options)\n\nOptimize the model in osw\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting._eval_regularization-Tuple{StellarSpectraObservationFitting.OrderModel, StellarSpectraObservationFitting.ModelWorkspace, AbstractVecOrMat{T} where T, AbstractVecOrMat{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting._eval_regularization","text":"_eval_regularization(om, mws, training_inds, testing_inds; kwargs...)\n\nTraining om on the training data, evaluating _loss() on the testing data after optimizing the RVs and scores\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting._loss_recalc_rv_basis-Tuple{StellarSpectraObservationFitting.Output, StellarSpectraObservationFitting.OrderModel, StellarSpectraObservationFitting.Data}","page":"Indices","title":"StellarSpectraObservationFitting._loss_recalc_rv_basis","text":"_loss_recalc_rv_basis(o, om, d; kwargs...)\n\n_loss() but including an AD-compliant way to recalcuate the Doppler basic vector \n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting._trapzx2-NTuple{4, Real}","page":"Indices","title":"StellarSpectraObservationFitting._trapzx2","text":"_trapzx2(x1, x2, y1, y2)\n\nTwice the area under the line between (x1, y1) and (x2, y2). Used in trapezoidal integration\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting._vander-Tuple{AbstractVector{T} where T, Int64}","page":"Indices","title":"StellarSpectraObservationFitting._vander","text":"_vander(x, n)\n\nCalculate the the Vandermonde matrix. See https://en.wikipedia.org/wiki/Vandermonde_matrix\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.affected_pixels!-Tuple{Vector{T} where T, AbstractVector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.affected_pixels!","text":"affected_pixels!(affected1, affected2)\n\nStore the indicies in both affected1 and affected2 in affected1\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.affected_pixels-Tuple{AbstractVecOrMat{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.affected_pixels","text":"affected_pixels(bad)\n\nStore the first indicies where bad` is true\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.aic-Tuple{Int64, Real}","page":"Indices","title":"StellarSpectraObservationFitting.aic","text":"Akaike information criterion\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.banded_inds-Tuple{Int64, Int64, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.banded_inds","text":"banded_inds(row, span, row_len)\n\nCalculate the bounds of the filled indices for row row of a banded matrix of span span\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.bic-Tuple{Int64, Real, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.bic","text":"Bayesian information criterion\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.bounds_generator!-Tuple{AbstractVector{T} where T, AbstractVector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.bounds_generator!","text":"bounds_generator!(bounds, xs)\n\nGetting the bounds of each element in xs assuming that they fully span the domain\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.bounds_generator-Tuple{AbstractVector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.bounds_generator","text":"bounds_generator!(xs)\n\nGetting the bounds of each element in xs assuming that they fully span the domain\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.calculate_initial_model-Tuple{StellarSpectraObservationFitting.Data}","page":"Indices","title":"StellarSpectraObservationFitting.calculate_initial_model","text":"calculate_initial_model(data; kwargs...)\n\nFind a SSOF model for a given dataset, data. Defaults to returning the AIC-minimum model\n\nOptional arguments\n\ninstrument::String=\"None\": The name of the instrument(s) the data was taken from. For bookeeping\ndesired_order::Int=0: What order (if any) the data was taken from. For bookeeping\nstar::String=\"None\": The name of the star the data was taken from. For bookeeping\ntimes::AbstractVector=1:size(data.flux, 2): The list of times (in days). Used to calculate intra-night RMS\nμ_min::Real=0: Set the minimum flux value for the output of make_template()\nμ_max::Real=Inf: Set the maximum flux value for the output of make_template()\nuse_mean::Bool=true: Whether to use the mean or median for make_template()\nstop_early::Bool=false: Whether to stop the model search the first time adding a component increases the AIC\nremove_reciprocal_continuum::Bool=false: Whether you should attempt to remove places where the telluric template and stellar template are opposing each other (i.e. where continuum goes up in one and down in the other)\nreturn_full_path::Bool=false: Whether to return all of the searched models and metrics\nmax_n_tel::Int=5: The maximum amount of telluric features vectors to look for\nmax_n_star::Int=5: The maximum amount of stellar features vectors to look for\nuse_all_comps::Bool=false: Whether to use all feature vectors, regardless of AIC\ncareful_first_step::Bool=true: Whether to shrink the learning rates until the loss improves on the first iteration\nspeed_up::Bool=false: Whether to inflate the learning rates until the loss is no longer improving throughout the optimization\nlog_λ_gp_star::Real=1/SOAP_gp_params.λ: The log λ lengthscale of the stellar regularization GP\nlog_λ_gp_tel::Real=1/LSF_gp_params.λ: The log λ lengthscale of the telluric regularization GP\nkwargs...: kwargs passed to OrderModel\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.check_converged-Tuple{StellarSpectraObservationFitting.AdamState, Real, Real, Real}","page":"Indices","title":"StellarSpectraObservationFitting.check_converged","text":"check_converged(as, f_reltol, g_reltol, g_L∞tol)\n\nCheck to see if the Adam optimization has coverged based on the change in loss or its gradient\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.check_for_valid_regularization-Tuple{Dict{Symbol, var\"#s158\"} where var\"#s158\"<:Real}","page":"Indices","title":"StellarSpectraObservationFitting.check_for_valid_regularization","text":"check_for_valid_regularization(reg)\n\nMake sure all the keys in reg are in SSOF.keylist\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.choose_reg_and_ℓ-Tuple{Vector{Symbol}, StellarSpectraObservationFitting.OrderModel, Symbol, Vector{var\"#s157\"} where var\"#s157\"<:Real, Vector{var\"#s156\"} where var\"#s156\"<:Real, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.choose_reg_and_ℓ","text":"choose_reg_and_ℓ(reg_fields, om, reg_key, reg_hold, ℓs, j)\n\nSet the reg_key regularization for om once the local minimum is found\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.clip_vector!-Tuple{Vector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.clip_vector!","text":"clip_vector!(vec; max=Inf, min=-Inf)\n\nSet values in vec above max to max and below min to min\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.copy_dict!-Tuple{Dict, Dict}","page":"Indices","title":"StellarSpectraObservationFitting.copy_dict!","text":"copy_dict!(to, from)\n\nCopy all entries in from to to\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.est_∇-Tuple{Function, Vector{var\"#s15\"} where var\"#s15\"<:Real}","page":"Indices","title":"StellarSpectraObservationFitting.est_∇","text":"est_∇(f, inputs; dif=1e-7, ignore_0_inputs=false)\n\nEstimate the gradient of f at inputs using finite differences.\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.estimate_σ_bootstrap-Tuple{StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.estimate_σ_bootstrap","text":"estimate_σ_bootstrap(mws; n=50, return_holders=false, recalc_mean=false, multithread=nthreads() > 3, verbose=true)\n\nEstimate the uncertainties (and potentially covariances) for the RVs and scores in mws based on looking at the distribution of best-fit parameters after re-injecting photon noise. Slower than estimate_σ_curvature(), but more reliable.\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.estimate_σ_bootstrap_helper!-Tuple{AbstractMatrix{T} where T, Any, Any, Int64, StellarSpectraObservationFitting.ModelWorkspace, AbstractMatrix{T} where T, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.estimate_σ_bootstrap_helper!","text":"estimate_σ_bootstrap_helper!(rv_holder, tel_holder, star_holder, i, mws, data_noise, n; verbose=true)\n\nRefit the RVs and scores after re-injecting photon noise and store the results in rv_holder, tel_holder, and star_holder\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.estimate_σ_bootstrap_reducer-Tuple{AbstractArray, AbstractArray, Function}","page":"Indices","title":"StellarSpectraObservationFitting.estimate_σ_bootstrap_reducer","text":"estimate_σ_bootstrap_reducer(shaper, holder, reducer)\n\nApply reducer on the first axis of holder and store the results in an array the shape of shaper\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.estimate_σ_curvature-Tuple{StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.estimate_σ_curvature","text":"estimate_σ_curvature(mws; kwargs...)\n\nEstimate the uncertainties for the RVs and scores in mws based on the local curvature of the loss function. Faster than estimate_σ_bootstrap(), but less reliable from ignoring cross terms in the Hessian.\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.estimate_σ_curvature_helper-Tuple{AbstractVecOrMat{T} where T, Function}","page":"Indices","title":"StellarSpectraObservationFitting.estimate_σ_curvature_helper","text":"estimate_σ_curvature_helper(x, ℓ; n=7, use_gradient=false, multithread=nthreads() > 3, print_every=10, kwargs...)\n\nEstimate the uncertainties for the best-fit parameters x for ~Gaussian function ℓ based on the local curvature\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.estimate_σ_curvature_helper_finalizer!-Tuple{AbstractVecOrMat{T} where T, AbstractVector{T} where T, AbstractVector{T} where T, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.estimate_σ_curvature_helper_finalizer!","text":"estimate_σ_curvature_helper_finalizer!(σs, _ℓs, x_test, i; use_gradient=false, param_str=\"\", print_every=10, verbose=false, show_plots=false)\n\nCalculate uncertanties (filling σs) based on the _ℓs calculated at x_test\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.eval_regularization-Tuple{Vector{Symbol}, Symbol, Real, StellarSpectraObservationFitting.ModelWorkspace, AbstractVecOrMat{T} where T, AbstractVecOrMat{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.eval_regularization","text":"eval_regularization(reg_fields, reg_key, reg_val, mws, training_inds, testing_inds; kwargs...)\n\nSetting regularizaiton values for a copy of mws.om then training it on the training data and evaluating _loss() on the testing data after optimizing the RVs and scores\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.finalize_scores!-Tuple{Function, StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.finalize_scores!","text":"finalize_scores!(score_trainer, mws)\n\nRun score_trainer and update the output in mws\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.finalize_scores!-Tuple{StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.finalize_scores!","text":"finalize_scores!(mws; kwargs...)\n\nOptimize the scores in mws\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.finalize_scores_setup-Tuple{StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.finalize_scores_setup","text":"finalize_scores_setup(mws; verbose=_verbose_def, f_tol=_f_reltol_def_s, g_tol=_g_L∞tol_def_s, careful_first_step=true, speed_up=false, kwargs...)\n\nCreate a function that optimizes the model scores with Optim\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.find_modes-Union{Tuple{Vector{T}}, Tuple{T}} where T<:Real","page":"Indices","title":"StellarSpectraObservationFitting.find_modes","text":"find_modes(data; amount=3)\n\nReturn the indices of local maxima of a data array\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.first_iterate!-Tuple{Function, Real, Vector{var\"#s12\"} where var\"#s12\"<:AbstractArray, AbstractArray{Float64, N} where N, AbstractArray{Float64, N} where N, StellarSpectraObservationFitting.Adam}","page":"Indices","title":"StellarSpectraObservationFitting.first_iterate!","text":"first_iterate!(l, l0, θs, θ, ∇θ, opt; ind=[], verbose=false)\n\nPerform an ADAM optimization step based on the contents of opt on θ and decreases the learning rate to ensure the loss actually decreases\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.fit_regularization!-Tuple{StellarSpectraObservationFitting.ModelWorkspace, AbstractVecOrMat{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.fit_regularization!","text":"fit_regularization!(mws, testing_inds; key_list=_key_list_fit, share_regs=false, kwargs...)\n\nFit all of the regularization values in key_list for the model in mws\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.fit_regularization!-Tuple{StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.fit_regularization!","text":"fit_regularization!(mws; verbose=true, testing_ratio=0.33, careful_first_step=true, speed_up=false, kwargs...)\n\nFind the best fit model withouth regularization then fit all of the regularization values in key_list for the model in mws\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.fit_regularization_helper!-Tuple{Vector{Symbol}, Symbol, Real, StellarSpectraObservationFitting.ModelWorkspace, AbstractVecOrMat{T} where T, AbstractVecOrMat{T} where T, Real, Real, Real}","page":"Indices","title":"StellarSpectraObservationFitting.fit_regularization_helper!","text":"fit_regularization_helper!(reg_fields, reg_key, before_ℓ, mws, training_inds, testing_inds, test_factor, reg_min, reg_max; start=10e3, cullable=Symbol[], robust_start=true, thres=8, kwargs...)\n\nSetting reg_key values in each Dict in mws.om.x (where x is each symbol in reg_fields) for a copy of mws.om then training it on the training data and evaluating _loss() on the testing data after optimizing the RVs and scores\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.flatten_ranges-Tuple{AbstractVector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.flatten_ranges","text":"flatten_ranges(ranges)\n\nReturns a range from the largest first element of those in ranges to the smallest last element of those in ranges\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.fwhm_2_σ-Tuple{Real}","page":"Indices","title":"StellarSpectraObservationFitting.fwhm_2_σ","text":"fwhm_2_σ(fwhm)\n\nConvert full-width at half-maximum to σ\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.general_lst_sq-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector{T} where T, Union{LinearAlgebra.Cholesky, LinearAlgebra.Diagonal}}} where T<:Real","page":"Indices","title":"StellarSpectraObservationFitting.general_lst_sq","text":"general_lst_sq(dm, data, Σ)\n\nSolve a weighted linear system of equations. See https://en.wikipedia.org/wiki/Generalizedleastsquares#Method_outline\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.general_lst_sq_f-Tuple{AbstractVector{T} where T, Any, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.general_lst_sq_f","text":"general_lst_sq_f(data, Σ, order; x=eachindex(data))\n\nGet a polynomial of order order fit to data\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.gp_Δℓ-Tuple{Any, AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.gp_Δℓ","text":"gp_Δℓ(y, A_k, Σ_k, H_k, P∞; kwargs...)\n\nCalculate the gradient of gp_ℓ() w.r.t. y\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.gp_Δℓ_coefficients-Tuple{Int64, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.gp_Δℓ_coefficients","text":"gp_Δℓ_coefficients(n, A_k, Σ_k; H_k=H_k, P∞=P∞, sparsity=0, kwargs...)\n\nPrecalculate coefficients that can be used to calculate gradient of gp_ℓ() w.r.t. y\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.gp_Δℓ_helper_K-Tuple{Int64, AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.gp_Δℓ_helper_K","text":"gp_Δℓ_helper_K(n, A_k, Σ_k, H_k, P∞; σ²_meas=_σ²_meas_def)\n\nPrecalculate all of the K matrices for at each time\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.gp_Δℓ_helper_γ-Tuple{Any, AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.gp_Δℓ_helper_γ","text":"gp_Δℓ_helper_γ(y, A_k, Σ_k, H_k, P∞; σ²_meas=_σ²_meas_def)\n\nPrecalculate all of the γ values for at each time\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.gp_ℓ-Tuple{Any, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.gp_ℓ","text":"gp_ℓ(y, A_k, Σ_k; σ²_meas=_σ²_meas_def, H_k=H_k, P∞=P∞)\n\nGetting the posterior likelihood that y is from a LTISDE described by A_k and Σ_k, equivalent to a GP\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.gp_ℓ_nabla-Tuple{Any, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.gp_ℓ_nabla","text":"gp_ℓ_nabla(y, A_k, Σ_k; σ²_meas=_σ²_meas_def, H_k=H_k, P∞=P∞)\n\nGetting the posterior likelihood that y is from a LTISDE described by A_k and Σ_k, equivalent to a GP. Same as gp_ℓ() but removing things that Nabla doesn't like\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.gp_ℓ_precalc-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.gp_ℓ_precalc","text":"gp_ℓ_precalc(ℓ_coeff, x, A_k, Σ_k; kwargs...)\n\nA version of gp_ℓ() using the coefficients calculated by gp_Δℓ_coefficients()\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.improve_initial_model!-Tuple{StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.improve_initial_model!","text":"improve_initial_model!(mws; careful_first_step=true, speed_up=false, kwargs...)\n\nTrain the model in mws with an extra step to ensure we are at a local maximum for the scores and RVs Defaults to taking a careful first step\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.improve_model!-Tuple{StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.improve_model!","text":"improve_model!(mws; verbose=true, kwargs...)\n\nTrain the model in mws with an extra step to ensure we are at a local maximum for the scores and RVs\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.insert_and_dedup!-Tuple{Vector{T} where T, Any}","page":"Indices","title":"StellarSpectraObservationFitting.insert_and_dedup!","text":"\tinsert_and_dedup!(v, x)\n\nInsert x into sorted list v without duplicates\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.int2ind-Tuple{AbstractVecOrMat{T} where T, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.int2ind","text":"int2ind(a, x)\n\nFind the index where x can be found in a\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.intra_night_std-Tuple{AbstractVector{T} where T, AbstractVector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.intra_night_std","text":"intra_night_std(rvs, times; thres=3, show_warn=true)\n\nCalculates the intra-night std for rvs time series observed at times (in days)\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.iterate!-Tuple{AbstractArray{Float64, N} where N, AbstractArray{Float64, N} where N, StellarSpectraObservationFitting.Adam}","page":"Indices","title":"StellarSpectraObservationFitting.iterate!","text":"iterate!(θ, ∇θ, opt)\n\nPerform an ADAM optimization step based on the contents of opt on θ\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.loss_func-Tuple{StellarSpectraObservationFitting.ModelWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.loss_func","text":"loss_func(mws; include_priors=false)\n\nCreate a loss function for the model and data in mws\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.loss_funcs_frozen_tel-Tuple{StellarSpectraObservationFitting.Output, StellarSpectraObservationFitting.OrderModel, StellarSpectraObservationFitting.Data}","page":"Indices","title":"StellarSpectraObservationFitting.loss_funcs_frozen_tel","text":"loss_funcs_frozen_tel(o, om, d)\n\nCreate loss functions for changing \t- the stellar templates, features, and scores and telluric scores \t- the telluric and stellar scores and RVs\n\nUsed to fit models with a set telluric model\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.loss_funcs_telstar-Tuple{StellarSpectraObservationFitting.Output, StellarSpectraObservationFitting.OrderModel, StellarSpectraObservationFitting.Data}","page":"Indices","title":"StellarSpectraObservationFitting.loss_funcs_telstar","text":"loss_funcs_telstar(o, om, d)\n\nCreate loss functions for changing \t- the telluric and stellar templates, features, and scores \t- the telluric and stellar scores \t- the RVs\n\nUsed to fit scores efficiently with L-BFGS\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.loss_funcs_total-Tuple{StellarSpectraObservationFitting.Output, StellarSpectraObservationFitting.OrderModelDPCA, StellarSpectraObservationFitting.Data}","page":"Indices","title":"StellarSpectraObservationFitting.loss_funcs_total","text":"loss_funcs_total(o, om, d)\n\nCreate loss functions for changing \t- the telluric and stellar templates, features, and scores \t- the telluric and stellar scores and RVs\n\nUsed to fit models with ADAM\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.make_template-Tuple{Matrix{T} where T, Matrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.make_template","text":"make_template(matrix, σ²; default=1., use_mean=false, kwargs...)\n\nReduce matrix to its median (or weighted mean) and clip the result\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.make_template-Tuple{Matrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.make_template","text":"make_template(matrix; use_mean=false, kwargs...)\n\nReduce matrix to its median (or mean) and clip the result\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.mask!-Tuple{AbstractVecOrMat{T} where T, AbstractVecOrMat{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.mask!","text":"mask!(var, bad_inds; using_weights=false)\n\nSetting var to reflect that the pixels at bad_inds should be masked\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.mask_stellar_feature!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, Real, Real}","page":"Indices","title":"StellarSpectraObservationFitting.mask_stellar_feature!","text":"mask_stellar_feature!(var, log_λ_star, log_λ_low, log_λ_high; verbose=true, inverse=false, kwargs...)\n\nMasking where log_λ_star is between (or outside if inverse=true) log_λ_low and log_λ_high\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.mask_stellar_pixel!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.mask_stellar_pixel!","text":"mask_stellar_pixel!(var, log_λ_star, log_λ_star_bounds, i; padding=0, verbose=true, kwargs...)\n\nMasking a pixel in the stellar frame to prevent different lines from coming in at different times\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.mask_telluric_feature!-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T, Real, Real}","page":"Indices","title":"StellarSpectraObservationFitting.mask_telluric_feature!","text":"mask_stellar_feature!(var, log_λ_obs, log_λ_star, log_λ_low, log_λ_high; verbose=true, include_bary_shifts=true, kwargs...)\n\nMasking where log_λ_obs is between log_λ_low and log_λ_high.  Can also perform in the stellar frame to prevent different lines from coming in at different times with include_bary_shifts\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.multiple_append!-Union{Tuple{T}, Tuple{Vector{T}, Vararg{Any, N} where N}} where T<:Real","page":"Indices","title":"StellarSpectraObservationFitting.multiple_append!","text":"multiple_append!(a, b...)\n\nGeneralized version of the Julia's append!() function\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.observation_night_inds-Tuple{AbstractVector{var\"#s11\"} where var\"#s11\"<:Real}","page":"Indices","title":"StellarSpectraObservationFitting.observation_night_inds","text":"observation_night_inds(times_in_days)\n\nFind the indices for each observing night\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.opt_funcs-Tuple{Function, AbstractVecOrMat{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.opt_funcs","text":"opt_funcs(loss, pars)\n\nCreate an objective object for Optim from loss that uses a flattened verison of pars\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.ordinary_lst_sq-Union{Tuple{T}, Tuple{AbstractMatrix{T}, AbstractVector{T} where T}} where T<:Real","page":"Indices","title":"StellarSpectraObservationFitting.ordinary_lst_sq","text":"ordinary_lst_sq(dm, data)\n\nSolve a linear system of equations. See https://en.wikipedia.org/wiki/Ordinaryleastsquares#Matrix/vector_formulation\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.ordinary_lst_sq_f-Tuple{AbstractVector{T} where T, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.ordinary_lst_sq_f","text":"ordinary_lst_sq_f(data, order; x=eachindex(data))\n\nGet a polynomial of order order fit to data\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.oversamp_interp-Tuple{Real, Real, AbstractVector{T} where T, AbstractVector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.oversamp_interp","text":"oversamp_interp(lo_x, hi_x, x, y)\n\nInterpolating by getting the average value of y from lo_x to hi_x\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.parse_args-Tuple{Int64, DataType, Any}","page":"Indices","title":"StellarSpectraObservationFitting.parse_args","text":"parse_args(ind, type, default)\n\nRetrieve ARGS[ind] as type type if it exists. Otherwise, return default\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.ratio_clarifier_string-Tuple{Real}","page":"Indices","title":"StellarSpectraObservationFitting.ratio_clarifier_string","text":"ratio_clarifier_string(ratio)\n\nConvert ratio to a nice 3 digit-rounded string\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.scale_α_helper!-Tuple{StellarSpectraObservationFitting.Adam, Real, AbstractVecOrMat{T} where T, Real, Bool}","page":"Indices","title":"StellarSpectraObservationFitting.scale_α_helper!","text":"scale_α_helper!(opt, α_ratio, θ, α, scale_α)\n\nOptionally scale opt.α based on the amplitudes in θ\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.searchsortednearest-Tuple{AbstractVector{T} where T<:Real, Real}","page":"Indices","title":"StellarSpectraObservationFitting.searchsortednearest","text":"searchsortednearest(a, x; lower=false)\n\nFind the index of the value closest to x in a (which is a sorted vector)\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.self_cor-Tuple{AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.self_cor","text":"self_cor(a; set_diag=true)\n\nGet the correlation matrix between the rows in a\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.speed_up_iterate!-Tuple{Function, Vector{var\"#s17\"} where var\"#s17\"<:AbstractArray, AbstractArray{Float64, N} where N, AbstractArray{Float64, N} where N, StellarSpectraObservationFitting.Adam}","page":"Indices","title":"StellarSpectraObservationFitting.speed_up_iterate!","text":"speed_up_iterate!(l, θs, θ, ∇θ, opt; ind=[], verbose=false)\n\nPerform an ADAM optimization step based on the contents of opt on θ and increases the learning rate to attempt to speed up the optimization\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.total_length-Tuple{StellarSpectraObservationFitting.AdamWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.total_length","text":"total_length(mws)\n\nCalculates the number of parameters of mws\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.train_OrderModel!-Tuple{StellarSpectraObservationFitting.AdamWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.train_OrderModel!","text":"train_OrderModel!(mws; ignore_regularization=false, verbose=_verbose_def, shift_scores=true, μ_positive=true, tel_μ_lt1=false, rm_doppler=true, kwargs...)\n\nTrain the model in mws with some optional modifications to the optimization (ignoreregularization, shiftscore, μpositive, telμlt1, rmdoppler)\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.train_OrderModel!-Tuple{StellarSpectraObservationFitting.OptimTelStarWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.train_OrderModel!","text":"train_OrderModel!(ow::OptimTelStarWorkspace; verbose=_verbose_def, iter=_iter_def, f_tol=_f_reltol_def, g_tol=_g_L∞tol_def, train_telstar=true, ignore_regularization=false, μ_positive=false, careful_first_step=true, speed_up=false, kwargs...)\n\nTrain the model in ow, training the telluric and stellar parameters, then the RVs\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.train_OrderModel!-Tuple{StellarSpectraObservationFitting.OptimTotalWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.train_OrderModel!","text":"train_OrderModel!(ow::OptimTelStarWorkspace; verbose=_verbose_def, iter=_iter_def, f_tol=_f_reltol_def, g_tol=_g_L∞tol_def, train_telstar=true, ignore_regularization=false, μ_positive=false, careful_first_step=true, speed_up=false, kwargs...)\n\nTrain the model in ow, training the telluric and stellar parameters, then the RVs\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.train_SubModel!-Tuple{StellarSpectraObservationFitting.AdamSubWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.train_SubModel!","text":"train_SubModel!(aws; iter=_iter_def, f_reltol=_f_reltol_def, g_reltol=_g_reltol_def, g_L∞tol=_g_L∞tol_def, cb=(as::AdamState)->(), careful_first_step=true, speed_up=false, kwargs...)\n\nTrain the model parameters in aws for up to iter Adam iterations until it converges based on check_converged()\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.train_rvs_optim!-Tuple{StellarSpectraObservationFitting.OptimSubWorkspace, AbstractVector{T} where T, Function}","page":"Indices","title":"StellarSpectraObservationFitting.train_rvs_optim!","text":"train_rvs_optim!(rv_ws, rv, optim_cb; g_tol=_g_L∞tol_def_s, f_tol=_f_reltol_def_s, iter=_iter_def, ignore_regularization=false, μ_positive=false, kwargs...)\n\nTrain the RVs from the rv_ws with Optim\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.trapz_small-Tuple{AbstractVector{T} where T, AbstractVector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.trapz_small","text":"trapz_small(x, y)\n\nTrapezoidal integration of y over x. Shamelessly modified from https://github.com/dextorious/NumericalIntegration.jl/blob/master/src/NumericalIntegration.jl.  See https://en.wikipedia.org/wiki/Trapezoidal_rule\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.trapz_small-Tuple{Real, Real, AbstractVector{T} where T, AbstractVector{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.trapz_small","text":"trapz_small(lo_x, hi_x, x, y)\n\nTrapezoidal integration of y over x from lo_x to hi_x. See https://en.wikipedia.org/wiki/Trapezoidal_rule\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.update!-Tuple{StellarSpectraObservationFitting.AdamSubWorkspace}","page":"Indices","title":"StellarSpectraObservationFitting.update!","text":"update!(aws; careful_first_step=true, speed_up=false)\n\nPerform an ADAM optimization step for the model parameters in aws\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.update_interpolation_locations!-Tuple{StellarSpectraObservationFitting.OrderModel, StellarSpectraObservationFitting.Data}","page":"Indices","title":"StellarSpectraObservationFitting.update_interpolation_locations!","text":"update_interpolation_locations!(om, d; use_mean=false)\n\nMake sure the linear iterpolation locations for going from the stellar model to the data are correct as the RVs change\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.vector_zero-Tuple{AbstractVecOrMat{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.vector_zero","text":"vector_zero(θ)\n\nGet a zero version of θ\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.wavenumber_to_Å-Tuple{Real}","page":"Indices","title":"StellarSpectraObservationFitting.wavenumber_to_Å","text":"wavenumber_to_Å(wn)\n\nConvert wn (in 1/cm) to wavelength (in Å)\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.weighted_mean-Tuple{AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.weighted_mean","text":"weighted_mean(x, σ²; default=0., kwargs...)\n\nCalculates the weighted mean of x given σ²\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.Å_to_wavenumber-Tuple{Real}","page":"Indices","title":"StellarSpectraObservationFitting.Å_to_wavenumber","text":"Å_to_wavenumber(λ)\n\nConvert λ (in Å) to wave number (in 1/cm)\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.Δℓ_precalc-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.Δℓ_precalc","text":"gp_ℓ_precalc(ℓ_coeff, x, A_k, Σ_k; kwargs...)\n\nCalculate the gradient of gp_ℓ_precalc() w.r.t. y\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.ℓ-Tuple{Real, Real, Int64}","page":"Indices","title":"StellarSpectraObservationFitting.ℓ","text":"Gaussian log-likelihood function\n\n\n\n\n\n","category":"method"},{"location":"indices/#StellarSpectraObservationFitting.ℓ_prereqs-Tuple{Matrix{T} where T}","page":"Indices","title":"StellarSpectraObservationFitting.ℓ_prereqs","text":"ℓ_prereqs(vars)\n\nCalculate some terms needed to calculate the log-likelihood\n\n\n\n\n\n","category":"method"},{"location":"empca/#EMPCA-functions","page":"(D)EMPCA","title":"EMPCA functions","text":"","category":"section"},{"location":"empca/","page":"(D)EMPCA","title":"(D)EMPCA","text":"Modules = [StellarSpectraObservationFitting]\nPages   = [\"src/DPCA_functions.jl\", \"src/EMPCA.jl\"]","category":"page"},{"location":"empca/#StellarSpectraObservationFitting.DEMPCA!-Union{Tuple{T}, Tuple{AbstractVecOrMat{T} where T, AbstractVecOrMat{T} where T, AbstractVector{T} where T, AbstractVector{T} where T, AbstractMatrix{T} where T, AbstractMatrix{T} where T, Vector{T}}} where T<:Real","page":"(D)EMPCA","title":"StellarSpectraObservationFitting.DEMPCA!","text":"DEMPCA!(M, scores, rv_scores, μ, data_temp, weights, doppler_comp; min_flux=0., max_flux=2., save_doppler_in_M1=true, kwargs...)\n\nPerform Doppler-constrained Expectation maximization PCA on data_temp\n\n\n\n\n\n","category":"method"},{"location":"empca/#StellarSpectraObservationFitting.doppler_component-Union{Tuple{T}, Tuple{AbstractVector{T}, Vector{T}}} where T<:Real","page":"(D)EMPCA","title":"StellarSpectraObservationFitting.doppler_component","text":"doppler_component(λ, flux)\n\nEstimate the basis vector that encodes the effects of a doppler shift based on Taylor expanding f(λ/(1 + z)) about z=0 doppler_comp = λ * dF/dλ -> units of flux\n\n\n\n\n\n","category":"method"},{"location":"empca/#StellarSpectraObservationFitting.doppler_component_AD-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}}} where T<:Real","page":"(D)EMPCA","title":"StellarSpectraObservationFitting.doppler_component_AD","text":"doppler_component_AD(λ, flux)\n\nEstimate the basis vector that encodes the effects of a doppler shift based on Taylor expanding f(λ/(1 + z)) about z=0. Autodiff friendly doppler_comp = λ * dF/dλ -> units of flux\n\n\n\n\n\n","category":"method"},{"location":"empca/#StellarSpectraObservationFitting.project_doppler_comp!-Tuple{AbstractVector{T} where T, AbstractMatrix{T} where T, AbstractVector{T} where T, AbstractMatrix{T} where T}","page":"(D)EMPCA","title":"StellarSpectraObservationFitting.project_doppler_comp!","text":"project_doppler_comp!(scores, data_temp, doppler_comp, weights)\n\nFinding the optimal scores to remove the weighted projection of doppler_comp from data_temp\n\n\n\n\n\n","category":"method"},{"location":"empca/#StellarSpectraObservationFitting.project_doppler_comp-Tuple{AbstractMatrix{T} where T, AbstractVector{T} where T, AbstractMatrix{T} where T}","page":"(D)EMPCA","title":"StellarSpectraObservationFitting.project_doppler_comp","text":"project_doppler_comp(data_temp, doppler_comp, weights)\n\nRemove the weighted projection of doppler_comp from data_temp\n\n\n\n\n\n","category":"method"},{"location":"empca/#StellarSpectraObservationFitting.simple_derivative-Tuple{AbstractVector{var\"#s16\"} where var\"#s16\"<:Real}","page":"(D)EMPCA","title":"StellarSpectraObservationFitting.simple_derivative","text":"simple_derivative(x)\n\nEstimate the derivative of x with finite differences (assuming unit separation)\n\n\n\n\n\n","category":"method"},{"location":"empca/#StellarSpectraObservationFitting.simple_derivative_AD-Tuple{Vector{var\"#s17\"} where var\"#s17\"<:Real}","page":"(D)EMPCA","title":"StellarSpectraObservationFitting.simple_derivative_AD","text":"simple_derivative_AD(x)\n\nEstimate the derivative of x with finite differences (assuming unit separation). Autodiff friendly\n\n\n\n\n\n","category":"method"},{"location":"empca/#ExpectationMaximizationPCA.EMPCA!-Tuple{StellarSpectraObservationFitting.FullLinearModel, AbstractMatrix{T} where T, AbstractMatrix{T} where T}","page":"(D)EMPCA","title":"ExpectationMaximizationPCA.EMPCA!","text":"EMPCA!(lm, data_tmp, weights; kwargs...)\n\nPerform Expectation maximization PCA on data_temp. See https://github.com/christiangil/ExpectationMaximizationPCA.jl\n\n\n\n\n\n","category":"method"},{"location":"LICENSE/#LICENSE","page":"LICENSE","title":"LICENSE","text":"","category":"section"},{"location":"LICENSE/","page":"LICENSE","title":"LICENSE","text":"using Markdown, StellarSpectraObservationFitting\nMarkdown.parse_file(joinpath(pkgdir(StellarSpectraObservationFitting), \"LICENSE.md\"))","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = StellarSpectraObservationFitting","category":"page"},{"location":"#StellarSpectraObservationFitting.jl-(SSOF,-*/suf/*-like-soufflé)-Documentation","page":"Home","title":"StellarSpectraObservationFitting.jl (SSOF, /suf/ like soufflé) Documentation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"(Image: SSOF model)","category":"page"},{"location":"","page":"Home","title":"Home","text":"StellarSpectraObservationFitting (SSOF) is a Julia package for creating data-driven models (with fast, physically-motivated Gaussian Process regularization) for the time-variable spectral features for both the telluric transmission and stellar spectrum measured by Extremely Precise Radial Velcotiy (EPRV) spectrographs. ","category":"page"},{"location":"#Where-to-begin?","page":"Home","title":"Where to begin?","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"If you haven't used SSOF before, a good place to start is the \"Getting Started\" section. We list how to install the package as well as a simple example","category":"page"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"gettingstarted.md\"]\nDepth = 2","category":"page"},{"location":"#Indices","page":"Home","title":"Indices","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"All of the package functions can be found here","category":"page"},{"location":"","page":"Home","title":"Home","text":"Pages = [\"indices.md\"]","category":"page"}]
}
